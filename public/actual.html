<!DOCTYPE html>
<html lang="en" width="100%" height="100%">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="./favicon.ico">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="/scripts/index.js" type="text/javascript"></script>
    
    <style>
        .record-text {
            font-size: 24px;
        }
        .table-title {
            font-size: 32px;
            text-decoration: underline;
        }
        .win-block {
            fill: lime;
            fill-opacity: .5;
        }
        .lose-block {
            fill: red;
            fill-opacity: .5;
        }
        .tie-block {
            fill: yellow;
            fill-opacity: .5;
        }
        .table-line {
            stroke: dimgray;
            stroke-width: 4;
        }
    </style>

    <title>Title</title>
</head>
<body width="100%" height="100%">
    <h1 class="className">Hello World</h1>
    <div id="container" style="width: 100%; height:100%">
        <svg id="content"></svg>
    </div>
    <button id="button">change</button>

    <script>
        var imageData = {
            "warlock": '/images/icons/icon_warlock.png',
            "warrior": '/images/icons/icon_warrior.png',
            "rogue": '/images/icons/icon_rogue.png',
            "priest": '/images/icons/icon_priest.png',
            "shaman": '/images/icons/icon_shaman.png',
            "paladin": '/images/icons/icon_paladin.png',
            "mage": '/images/icons/icon_mage.png',
            "hunter": '/images/icons/icon_hunter.png',
            "druid": '/images/icons/icon_druid.png'
        };

        var data = [
            {"class": "placeholder"},
            {"class": "warlock", "records": [
                {"class": "warlock", "wins": 2, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 2, "losses": 2}, 
                {"class": "shaman", "wins": 2, "losses": 2}, 
                {"class": "priest", "wins": 2, "losses": 2}, 
                {"class": "rogue", "wins": 2, "losses": 2}, 
                {"class": "hunter", "wins": 2, "losses": 2}, 
                {"class": "mage", "wins": 2, "losses": 2}, 
                {"class": "druid", "wins": 2, "losses": 2}
            ]},
            {"class": "warrior", "records": [
                {"class": "warlock", "wins": 1, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 3, "losses": 2}, 
                {"class": "shaman", "wins": 4, "losses": 2}, 
                {"class": "priest", "wins": 5, "losses": 2}, 
                {"class": "rogue", "wins": 6, "losses": 2}, 
                {"class": "hunter", "wins": 7, "losses": 2}, 
                {"class": "mage", "wins": 8, "losses": 2}, 
                {"class": "druid", "wins": 9, "losses": 2}
            ]},
            {"class": "paladin", "records": [
                {"class": "warlock", "wins": 2, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 2, "losses": 2}, 
                {"class": "shaman", "wins": 2, "losses": 2}, 
                {"class": "priest", "wins": 2, "losses": 2}, 
                {"class": "rogue", "wins": 2, "losses": 2}, 
                {"class": "hunter", "wins": 2, "losses": 2}, 
                {"class": "mage", "wins": 2, "losses": 2}, 
                {"class": "druid", "wins": 2, "losses": 2}
            ]},
            {"class": "shaman", "records": [
                {"class": "warlock", "wins": 2, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 2, "losses": 2}, 
                {"class": "shaman", "wins": 2, "losses": 2}, 
                {"class": "priest", "wins": 2, "losses": 2}, 
                {"class": "rogue", "wins": 2, "losses": 2}, 
                {"class": "hunter", "wins": 2, "losses": 2}, 
                {"class": "mage", "wins": 2, "losses": 2}, 
                {"class": "druid", "wins": 2, "losses": 2}
            ]},
            {"class": "priest", "records": [
                {"class": "warlock", "wins": 2, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 2, "losses": 2}, 
                {"class": "shaman", "wins": 2, "losses": 2}, 
                {"class": "priest", "wins": 2, "losses": 2}, 
                {"class": "rogue", "wins": 2, "losses": 2}, 
                {"class": "hunter", "wins": 2, "losses": 2}, 
                {"class": "mage", "wins": 2, "losses": 2}, 
                {"class": "druid", "wins": 2, "losses": 2}
            ]},
            {"class": "rogue", "records": [
                {"class": "warlock", "wins": 2, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 2, "losses": 2}, 
                {"class": "shaman", "wins": 2, "losses": 2}, 
                {"class": "priest", "wins": 2, "losses": 2}, 
                {"class": "rogue", "wins": 2, "losses": 2}, 
                {"class": "hunter", "wins": 2, "losses": 2}, 
                {"class": "mage", "wins": 2, "losses": 2}, 
                {"class": "druid", "wins": 2, "losses": 2}
            ]},
            {"class": "hunter", "records": [
                {"class": "warlock", "wins": 2, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 2, "losses": 2}, 
                {"class": "shaman", "wins": 2, "losses": 2}, 
                {"class": "priest", "wins": 2, "losses": 2}, 
                {"class": "rogue", "wins": 2, "losses": 2}, 
                {"class": "hunter", "wins": 2, "losses": 2}, 
                {"class": "mage", "wins": 2, "losses": 2}, 
                {"class": "druid", "wins": 2, "losses": 2}
            ]},
            {"class": "mage", "records": [
                {"class": "warlock", "wins": 2, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 2, "losses": 2}, 
                {"class": "shaman", "wins": 2, "losses": 2}, 
                {"class": "priest", "wins": 2, "losses": 2}, 
                {"class": "rogue", "wins": 2, "losses": 2}, 
                {"class": "hunter", "wins": 2, "losses": 2}, 
                {"class": "mage", "wins": 2, "losses": 2}, 
                {"class": "druid", "wins": 2, "losses": 2}
            ]},
            {"class": "druid", "records": [
                {"class": "warlock", "wins": 2, "losses": 2},
                {"class": "warrior", "wins": 2, "losses": 2},
                {"class": "paladin", "wins": 2, "losses": 2}, 
                {"class": "shaman", "wins": 2, "losses": 2}, 
                {"class": "priest", "wins": 2, "losses": 2}, 
                {"class": "rogue", "wins": 2, "losses": 2}, 
                {"class": "hunter", "wins": 2, "losses": 2}, 
                {"class": "mage", "wins": 2, "losses": 2}, 
                {"class": "druid", "wins": 2, "losses": 2}
            ]},
        ];

        var margin = {top: 85, right: 20, bottom: 40, left: 80};
        var width = 1100 - margin.right - margin.left;
        var height = 700 - margin.top - margin.bottom;

        // init scales
        var scaleX = d3.scaleBand().rangeRound([0, width]);
        var scaleY = d3.scaleBand().rangeRound([0, height]);

        var xAxis = d3.axisTop(scaleX);
        var yAxis = d3.axisLeft(scaleY);

        var chart = d3.select("#content")
            .attr("preserveAspectRatio", "xMinYMin meet")
            .attr("viewBox", "0 0 " + (width + margin.left + margin.left) + " " + (height + margin.top + margin.bottom))
            .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


        scaleX.domain(data.map(function(d) { return d.class }));
        scaleY.domain(data.map(function(d) { return d.class }));

        // Vertical Lines
        chart.selectAll(".y .table-line")
            .data(data)
            .enter()
            .append("line")
                .attr("x1", function(d) { return scaleX(d.class) })
                .attr("x2", function(d) { return scaleX(d.class) })
                .attr("y1", 0)
                .attr("y2", height - scaleY.bandwidth())
                .attr("class", "y table-line")

        // Images on top
        chart.selectAll(".y-image")
            .data(data.slice(1))
            .enter()
            .append("svg:image")
                .attr("width", 38)
                .attr("height", 37)
                .attr("y", -40)
                .attr("x", function(d) { return scaleX(d.class) - (scaleX.bandwidth() / 1.5)})
                .attr("xlink:href", function(d) { return imageData[d.class] })
                .attr("class", "y-image");

        // Horizontal Lines
        chart.selectAll(".x .table-line")
            .data(data)
            .enter()
            .append("line")
                .attr("x1", 0)
                .attr("x2", width - scaleX.bandwidth())
                .attr("y1", function(d) { return scaleY(d.class) })
                .attr("y2", function(d) { return scaleY(d.class) })
                .attr("class", "x table-line");

        // Images on top
        chart.selectAll(".x-image")
            .data(data.slice(1))
            .enter()
            .append("svg:image")
                .attr("width", 38)
                .attr("height", 37)
                .attr("y", function(d) { return scaleY(d.class) - (scaleY.bandwidth() * 0.8)})
                .attr("x", -50)
                .attr("xlink:href", function(d) { return imageData[d.class] })
                .attr("class", "x-image");

        // Columns for recrds + background rects
        var columns = chart.selectAll(".column")
            .data(data.slice(1))
            .enter()
            .append("g")
                .attr("class", "column")
                .attr("transform", function(d) { return "translate(" + (scaleX(d.class) - (scaleX.bandwidth() / 1.5)) + ")" });
         
        // Background rects   
        columns.selectAll("rect")
            .data(function(d) { return d.records})
            .enter()
            .append("rect")
                .attr("width", scaleX.bandwidth() - 4)
                .attr("height", scaleY.bandwidth() - 4)
                .attr("x", -(scaleX.bandwidth() * 0.32))
                .attr("y", function(d) { return scaleY(d.class) - (scaleY.bandwidth() - 2) })
                .attr("class", function(d) { 
                    if (d.wins > d.losses) 
                        return "win-block"
                    else if (d.wins < d.losses)
                        return "lose-block"
                    else
                        return "tie-block"
                });

        // Records
        columns.selectAll("text")
            .data(function(d) { return d.records})
            .enter()
            .append("text")
                .html(function(d) { return d.wins + " - " + d.losses })
                .attr("y", function(d) { return scaleY(d.class) - (scaleY.bandwidth() / 2) })
                .attr("class", "record-text");

        // Title
        chart.append("g")
            .attr("transform", "translate(" + (width * .4) + "," + (-20 - margin.bottom) + ")")
            .append("text")
                .html("Your Class")
                .attr("class", "table-title")

    </script>
</body>
</html>




