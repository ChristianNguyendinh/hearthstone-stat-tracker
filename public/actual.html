<!DOCTYPE html>
<html lang="en" width="100%" height="100%">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="./favicon.ico">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="/scripts/index.js" type="text/javascript"></script>
    
    <style>
        .tooltipContainer {
            fill: none;
            stroke: #2f2f2f; 
            stroke-width:3;
            color: #333; 
            display: none;
            height: 120px;
            width: 120px;
        }

        .tooltipText {
            font-size: 48px;
            display: none;
        }

        path:hover {
            stroke: #2f2f2f; 
            stroke-width: 3;
        }

    </style>

    <title>Title</title>
</head>
<body width="100%" height="100%">
    <h1 class="className">Hello World</h1>
    <div id="container" style="width: 100%; height:100%">
        <svg id="content"></svg>
    </div>
    <button id="button">change</button>

    <script>
        var width = 960
        var height = 500
        var radius = Math.min(width, height) / 2;

        var data = [.61, .39];


        var color = d3.scaleOrdinal()
            .range(["#4286f4", "#ef3b56"]);

        var arc = d3.arc()
            .outerRadius(radius - 10)
            .innerRadius(radius - 100);

        var pie = d3.pie()
            .sort(null)
            .value(function(d) { return d; });

        var chart = d3.select("#content")
            .attr("preserveAspectRatio", "xMinYMin meet")
            .attr("viewBox", "0 0 " + width + " " + height)
            .append("g")
                .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

        var tipContainer = chart.append('rect')
            .attr('x', -60)
            .attr('y', -65)
            .attr('class', 'tooltipContainer')
            .attr('rx', '15')
            .attr('ry', '15');

        var tooltip = chart.append('text')
            .attr('class', 'tooltipText')
            .attr('x', -40)
            .attr('y', 10);

        var g = chart.selectAll(".arc")
            .data(pie(data))
            .enter().append("g")
            .attr("class", "arc");

        g.append("path")
            .attr("d", arc)
            .style("fill", function(d) { return color(d.data); })
            .on("mouseover", function(d) {
                var total = d.data;
                tooltip.html(d.data * 100 + '%');
                tooltip.style('display', 'block');
                tipContainer.style('display', 'block');
            })
            .on("mouseout", function() {
                tooltip.style('display', 'none');
                tipContainer.style('display', 'none');
            });

        // g.append("text")
        //  .attr("transform", function(d) { return "translate(" + labelArc.centroid(d) + ")"; })
        //  .attr("dy", ".35em")
        //  .text(function(d) { return d.data; });

        // update
        document.getElementById("button").onclick = function(e) {
            console.log("asdf");

            var data1 = [.9, .1];
            
            // get the joins for the new data
            var r = chart.selectAll(".arc")
                .data(pie(data1));

            // update the rest
            r.select("path").transition().duration(1000)
                .attr("d", arc)
                .style("fill", function(d) { return color(d.data); })
                .on("mouseover", function(d) {
                    var total = d.data;
                    tooltip.html(d.data * 100 + '%');
                    tooltip.style('display', 'block');
                    tipContainer.style('display', 'block');
                })
                .on("mouseout", function() {
                    tooltip.style('display', 'none');
                    tipContainer.style('display', 'none');
                });
        }
    </script>
</body>
</html>